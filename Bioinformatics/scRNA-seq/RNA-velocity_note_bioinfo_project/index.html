
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Lumi's Blog">
      
      
        <meta name="author" content="Lumi">
      
      
        <link rel="canonical" href="https://bhaaa-zlm.github.io/Bioinformatics/scRNA-seq/RNA-velocity_note_bioinfo_project/">
      
      
        <link rel="prev" href="../../">
      
      
        <link rel="next" href="../../">
      
      
      <link rel="icon" href="../../../assets/image/fatLogo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>RNA-velocity Analysis for Bioinfo Project - Lumi's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Libre Baskerville";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#to-do-list" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Lumi&#39;s Blog" class="md-header__button md-logo" aria-label="Lumi's Blog" data-md-component="logo">
      
  <img src="../../../assets/image/fatLogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Lumi's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              RNA-velocity Analysis for Bioinfo Project
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/BHAAA-ZLM/BHAAA-ZLM.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    BHAAA-ZLM.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Life/" class="md-tabs__link">
          
  
  
    
  
  Life

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Bioinformatics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Biology/" class="md-tabs__link">
          
  
  
    
  
  Biology

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../CS/" class="md-tabs__link">
          
  
  
    
  
  CS

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Learning/" class="md-tabs__link">
          
  
  
    
  
  Learning

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../About/" class="md-tabs__link">
          
  
  
    
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Lumi&#39;s Blog" class="md-nav__button md-logo" aria-label="Lumi's Blog" data-md-component="logo">
      
  <img src="../../../assets/image/fatLogo.png" alt="logo">

    </a>
    Lumi's Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BHAAA-ZLM/BHAAA-ZLM.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    BHAAA-ZLM.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Life/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Life
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Books I Read
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Books I Read
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Life/Books/TAOS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Art of Statistics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Life/colours_pub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Colours from Publications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Life/writing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Writing in Hourglass Style
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Bioinformatics
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Bioinformatics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    scRNA-Seq
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            scRNA-Seq
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    RNA-velocity Analysis for Bioinfo Project
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    RNA-velocity Analysis for Bioinfo Project
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#to-do-list" class="md-nav__link">
    <span class="md-ellipsis">
      To Do List
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-from-geo-files" class="md-nav__link">
    <span class="md-ellipsis">
      Starting from GEO files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Starting from GEO files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chromaffin-cells-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Chromaffin Cells Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chromaffin Cells Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acquiring-data-from-geo" class="md-nav__link">
    <span class="md-ellipsis">
      Acquiring Data from GEO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-mm10-index-for-star-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      Making mm10 index for STAR alignment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#star-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      STAR alignment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STAR alignment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aligning-together-and-splitting" class="md-nav__link">
    <span class="md-ellipsis">
      Aligning Together and Splitting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aligning-one-by-one" class="md-nav__link">
    <span class="md-ellipsis">
      Aligning One-by-one
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#velocyto-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Velocyto Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Velocyto Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preperation" class="md-nav__link">
    <span class="md-ellipsis">
      Preperation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#one-by-one-output-bams" class="md-nav__link">
    <span class="md-ellipsis">
      One-by-one output BAMs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#squashed-bams" class="md-nav__link">
    <span class="md-ellipsis">
      Squashed BAMs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hippocampus" class="md-nav__link">
    <span class="md-ellipsis">
      Hippocampus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-from-aligned-bam-files" class="md-nav__link">
    <span class="md-ellipsis">
      Starting from Aligned Bam files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Starting from Aligned Bam files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downloading-new-bam-files" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading new Bam files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-velocyto" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis of Velocyto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis of Velocyto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-loom-files" class="md-nav__link">
    <span class="md-ellipsis">
      Obtaining the .loom Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis-with-r-and-python" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis with R and Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis with R and Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r" class="md-nav__link">
    <span class="md-ellipsis">
      R
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#huge-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Huge Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis-with-scvelo" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis with scVelo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    RNA-Seq
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            RNA-Seq
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../RNA-seq/RNA-seq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Basic Workflow of RNA-seq
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../RNA-seq/Files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Files involved in RNA-seq
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../RNA-seq/Tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Tools of RNA-seq
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ATAC-Seq
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            ATAC-Seq
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ATAC-Seq/ATAC-Seq_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tools in ATAC-Seq
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    R the Programming Language
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            R the Programming Language
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../R/DESeq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    R and DESeq2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Biology/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Biology
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Biology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Experiments
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Experiments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Biology/Experiments/BIOS201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genome-Why are we different
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Structural Biology
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Structural Biology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Biology/Struct/protein_purification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Protein Expression with Sf9 Cells
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Biology/Struct/Chimera_visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization with ChimeraX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Biology/Struct/coot_install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing Coot on Mac
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Biology/Struct/ctf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Contrast Transfer Function
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../CS/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CS
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Learning CS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Learning CS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Learn%20CS/Logic_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning Mathematical Logic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Learn%20CS/Discrete_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning Discrete Mathematics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Learn%20CS/Markdown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning Markdown
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Learn%20CS/R/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning R
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Learn%20CS/Marp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning Marp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Learn%20CS/zotero_WebDAV/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setting Up Zotero Sync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Learn%20CS/mandelbrot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Drawing Mandelbrot Set with Python
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Projects
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CS/Projects/ChessKing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    My First Project - ChessKing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Learning/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Learning
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chemistry
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Chemistry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Learning/Chemistry/Experiments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chemistry Experiments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Physics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Physics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Learning/Physics/Quantum/Basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum Mechanics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Learning/Physics/fly_by_night/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fly By Night
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../About/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../About/SelfIntro/SelfIntro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Me
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#to-do-list" class="md-nav__link">
    <span class="md-ellipsis">
      To Do List
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-from-geo-files" class="md-nav__link">
    <span class="md-ellipsis">
      Starting from GEO files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Starting from GEO files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chromaffin-cells-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Chromaffin Cells Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chromaffin Cells Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acquiring-data-from-geo" class="md-nav__link">
    <span class="md-ellipsis">
      Acquiring Data from GEO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-mm10-index-for-star-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      Making mm10 index for STAR alignment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#star-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      STAR alignment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STAR alignment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aligning-together-and-splitting" class="md-nav__link">
    <span class="md-ellipsis">
      Aligning Together and Splitting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aligning-one-by-one" class="md-nav__link">
    <span class="md-ellipsis">
      Aligning One-by-one
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#velocyto-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Velocyto Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Velocyto Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preperation" class="md-nav__link">
    <span class="md-ellipsis">
      Preperation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#one-by-one-output-bams" class="md-nav__link">
    <span class="md-ellipsis">
      One-by-one output BAMs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#squashed-bams" class="md-nav__link">
    <span class="md-ellipsis">
      Squashed BAMs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hippocampus" class="md-nav__link">
    <span class="md-ellipsis">
      Hippocampus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-from-aligned-bam-files" class="md-nav__link">
    <span class="md-ellipsis">
      Starting from Aligned Bam files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Starting from Aligned Bam files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downloading-new-bam-files" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading new Bam files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-velocyto" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis of Velocyto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis of Velocyto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-loom-files" class="md-nav__link">
    <span class="md-ellipsis">
      Obtaining the .loom Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis-with-r-and-python" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis with R and Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis with R and Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r" class="md-nav__link">
    <span class="md-ellipsis">
      R
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#huge-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Huge Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis-with-scvelo" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis with scVelo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

        <!-- Edit button -->
        
          <a
            href="https://github.com/BHAAA-ZLM/BHAAA-ZLM.github.io/edit/master/docs/Bioinformatics/scRNA-seq/RNA-velocity_note_bioinfo_project.md"
            title="edit.link.title"
            class="md-content__button md-icon"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
          </a>
        

        <!--
          Hack: check whether the content contains a h1 headline. If it
          doesn't, the page title (or respectively site name) is used
          as the main headline.
        -->
        
          <h1>RNA-velocity Analysis for Bioinfo Project</h1>
        

        <!-- Markdown content -->
        
        <aside class="mdx-author">
            <p>
            <img src="https://avatars.githubusercontent.com/BHAAA-ZLM" alt="@BHAAA-ZLM">
            </p>
            <p>
            <span> 
            <b>Lumi</b>  <a href="https://github.com/BHAAA-ZLM">@BHAAA-ZLM</a>
            </span>
            <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar2" viewBox="0 0 16 16">
                    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H2z"/>
                    <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V4z"/>
                  </svg> 2024.06.20 
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock" viewBox="0 0 16 16">
                    <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                    <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
                  </svg> 15min read
            </span>
            </p>
        </aside>
        

        <p>This is my note &amp; plan markdown for my bioinformatics project about RNA velocity anlaysis. The project is about reproducing some of the results, and I think this markdown is quite helpful for further analysis. So I put it here in my blog, in case I might need it in the future. All the other codes are stored in the GitHub repository for <a href="https://github.com/BHAAA-ZLM/RNA-velocity_Review">this project</a>.</p>
<h2 id="to-do-list">To Do List</h2>
<ul>
<li>
<p>[x] Perform velocyto analysis on the already single Bam files.</p>
<div class="language-text highlight"><pre><span></span><code>- [x] Find out what happened to the python error output.
- [ ] Check the mask GTF file to see what problems is it causing.
- [x] Inspect the GTF file to see if it might be the cause of all the problems.
</code></pre></div>
</li>
<li>
<p>[x] Perform velocyto analysis on the squashed and then seperated Bam files.</p>
</li>
<li>[ ] Try <code>cellranger</code> pipeline for other datasets.</li>
<li>[x] Prepare files required for velocyto analysis.</li>
<li>[x] Turn the squashed Bam into multiple Bam files.</li>
<li>[x] Figure out a way to run <code>velocyto</code> somewhere.</li>
</ul>
<h2 id="starting-from-geo-files">Starting from GEO files</h2>
<h3 id="environment-setup">Environment Setup</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># A new conda environment on taiyi</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>pre<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.8
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># install required packages</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>conda<span class="w"> </span>install<span class="w"> </span>numpy<span class="w"> </span>scipy<span class="w"> </span>cython<span class="w"> </span>numba<span class="w"> </span>matplotlib<span class="w"> </span>scikit-learn<span class="w"> </span>h5py<span class="w"> </span>click
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>pip<span class="w"> </span>install<span class="w"> </span>velocyto
</span></code></pre></div>
<h3 id="chromaffin-cells-analysis">Chromaffin Cells Analysis</h3>
<p>In the directory <code>/scratch/2024-05-04/bio-zhanglm/bioinfo/chromaffin</code>.</p>
<h4 id="acquiring-data-from-geo">Acquiring Data from GEO</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="ch">#!/bin/sh                          </span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1">#BSUB -J N_F                        ##job name</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1">#BSUB -q ser                     ##queue name</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1">#BSUB -n 10                        ##number of total cores     </span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1">#BSUB -R &quot;span[ptile=40]&quot;          ##40 cores per node</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1">#BSUB -W 12:00                     ##walltime in hh:mm </span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1">#BSUB -R &quot;select[hname!=&#39;r13n18&#39;]&quot; ##exclusive r13n18</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1">#BSUB -e log/err.log                   ##error log</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c1">#BSUB -o log/H.log                     ##output log</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="nb">cd</span><span class="w"> </span>/scratch/2024-05-04/bio-zhanglm/bioinfo/chromaffin
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>geofetch<span class="w"> </span>-i<span class="w"> </span>GSE99933
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>mkdir<span class="w"> </span>fastq<span class="w"> </span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>ls<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="k">do</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">    </span>fastq-dump<span class="w"> </span>--outdir<span class="w"> </span>fastq<span class="w"> </span><span class="nv">$line</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="k">done</span>
</span></code></pre></div>
<h4 id="making-mm10-index-for-star-alignment">Making mm10 index for STAR alignment</h4>
<p>The mm10 reference directory is <code>/data/bio-zhanglm/genome/mm10</code>.
STAR was setup in the <code>(base)</code> environment.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">cd</span><span class="w"> </span>/data/bio-zhanglm/genome/mm10
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>wget<span class="w"> </span>https://ftp.ensembl.org/pub/release-111/fasta/mus_musculus/dna/Mus_musculus.GRCm39.dna_sm.toplevel.fa.gz
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>wget<span class="w"> </span>https://ftp.ensembl.org/pub/release-111/gtf/mus_musculus/Mus_musculus.GRCm39.111.gtf.gz
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1"># &#39;dna_sm&#39; - soft-masked genomic DNA. </span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># All repeats and low complexity regions have been replaced </span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># with lowercased versions of their nucleic base</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>gunzip<span class="w"> </span>Mus_musculus.GRCm39.111.gtf.gz
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>gunzip<span class="w"> </span>Mus_musculus.GRCm39.dna_sm.toplevel.fa.gz
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>STAR<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">        </span>--runThreadN<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">        </span>--runMode<span class="w"> </span>genomeGenerate<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">        </span>--genomeDir<span class="w"> </span>/data/bio-zhanglm/genome/mm10<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="w">        </span>--genomeFastaFiles<span class="w"> </span>Mus_musculus.GRCm39.dna_sm.toplevel.fa<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="w">        </span>--sjdbGTFfile<span class="w"> </span>Mus_musculus.GRCm39.111.gtf
</span></code></pre></div></p>
<p>Out put:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>STAR<span class="w"> </span>--runThreadN<span class="w"> </span><span class="m">25</span><span class="w"> </span>--runMode<span class="w"> </span>genomeGenerate<span class="w"> </span>--genomeDir<span class="w"> </span>/data/bio-zhanglm/genome/mm10<span class="w"> </span>--genomeFastaFiles<span class="w"> </span>Mus_musculus.GRCm39.dna_sm.toplevel.fa<span class="w"> </span>--sjdbGTFfile<span class="w"> </span>Mus_musculus.GRCm39.111.gtf
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">        </span>STAR<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.7.10b<span class="w">   </span>compiled:<span class="w"> </span><span class="m">2022</span>-11-01T09:53:26-04:00<span class="w"> </span>:/home/dobin/data/STAR/STARcode/STAR.master/source
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:43:29<span class="w"> </span>.....<span class="w"> </span>started<span class="w"> </span>STAR<span class="w"> </span>run
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:43:29<span class="w"> </span>...<span class="w"> </span>starting<span class="w"> </span>to<span class="w"> </span>generate<span class="w"> </span>Genome<span class="w"> </span>files
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:44:14<span class="w"> </span>.....<span class="w"> </span>processing<span class="w"> </span>annotations<span class="w"> </span>GTF
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:44:35<span class="w"> </span>...<span class="w"> </span>starting<span class="w"> </span>to<span class="w"> </span>sort<span class="w"> </span>Suffix<span class="w"> </span>Array.<span class="w"> </span>This<span class="w"> </span>may<span class="w"> </span>take<span class="w"> </span>a<span class="w"> </span>long<span class="w"> </span>time...
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:44:47<span class="w"> </span>...<span class="w"> </span>sorting<span class="w"> </span>Suffix<span class="w"> </span>Array<span class="w"> </span>chunks<span class="w"> </span>and<span class="w"> </span>saving<span class="w"> </span>them<span class="w"> </span>to<span class="w"> </span>disk...
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:50:58<span class="w"> </span>...<span class="w"> </span>loading<span class="w"> </span>chunks<span class="w"> </span>from<span class="w"> </span>disk,<span class="w"> </span>packing<span class="w"> </span>SA...
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:52:04<span class="w"> </span>...<span class="w"> </span>finished<span class="w"> </span>generating<span class="w"> </span>suffix<span class="w"> </span>array
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:52:04<span class="w"> </span>...<span class="w"> </span>generating<span class="w"> </span>Suffix<span class="w"> </span>Array<span class="w"> </span>index
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:56:09<span class="w"> </span>...<span class="w"> </span>completed<span class="w"> </span>Suffix<span class="w"> </span>Array<span class="w"> </span>index
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:56:09<span class="w"> </span>.....<span class="w"> </span>inserting<span class="w"> </span>junctions<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>genome<span class="w"> </span>indices
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:59:04<span class="w"> </span>...<span class="w"> </span>writing<span class="w"> </span>Genome<span class="w"> </span>to<span class="w"> </span>disk<span class="w"> </span>...
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:59:04<span class="w"> </span>...<span class="w"> </span>writing<span class="w"> </span>Suffix<span class="w"> </span>Array<span class="w"> </span>to<span class="w"> </span>disk<span class="w"> </span>...
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:59:21<span class="w"> </span>...<span class="w"> </span>writing<span class="w"> </span>SAindex<span class="w"> </span>to<span class="w"> </span>disk
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>May<span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">15</span>:59:24<span class="w"> </span>.....<span class="w"> </span>finished<span class="w"> </span>successfully
</span></code></pre></div></p>
<h3 id="star-alignment">STAR alignment</h3>
<h4 id="aligning-together-and-splitting">Aligning Together and Splitting</h4>
<p>First we construct a tab delimited file matching the sequence to the cell barcode (in our case GEO session number).
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>ls<span class="w"> </span>fastq/*.fastq<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line<span class="w"> </span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">do</span><span class="w"> </span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">        </span><span class="c1"># STAR requires 3 columns, second should be &quot;-&quot; in single-end sequencing.</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;fastq/</span><span class="si">${</span><span class="nv">line</span><span class="si">}</span><span class="s2">.fastq\t-\t</span><span class="si">${</span><span class="nv">line</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">done</span><span class="w"> </span>&gt;<span class="w"> </span>manifest.tsv
</span></code></pre></div>
Then we align the sequences to the genome using the <code>--readFilesManifest</code> option in STAR. Also we specified the sequencing method with <code>--soloType SmartSeq</code>.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Submitted as ll_star_02.txt</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>STAR<span class="w"> </span>--runThreadN<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">        </span>--genomeDir<span class="w"> </span>/data/bio-zhanglm/genome/mm10<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">        </span>--readFilesManifest<span class="w"> </span>manifest.tsv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">        </span>--outFileNamePrefix<span class="w"> </span>./mapping/split/chromaffin.<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">        </span>--outSAMtype<span class="w"> </span>BAM<span class="w"> </span>SortedByCoordinate<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span>--quantMode<span class="w"> </span>GeneCounts<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span>--soloType<span class="w"> </span>SmartSeq<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">        </span>--soloUMIdedup<span class="w"> </span>Exact<span class="w"> </span>NoDedup<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">        </span>--outSAMattributes<span class="w"> </span>NH<span class="w"> </span>HI<span class="w"> </span>AS<span class="w"> </span>nM<span class="w"> </span>RG
</span></code></pre></div></p>
<p>STARsolo's github page said that: </p>
<blockquote>
<p>Cell-id can be any string without spaces. Cell-id will be added as ReadGroup tag (RG:Z:) for each read in the SAM/BAM output. If Cell-id starts with ID:, it can contain several fields separated by tab, and all the fields will be copied verbatim into SAM @RG header line.</p>
</blockquote>
<p>Thus we might try to split the BAM file into multiple BAM files based on the cell barcode with <code>samtools split</code>, which by default separate with the <code>@RG</code> header. </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># at /scratch/2024-05-11/bio-zhanglm/bioinfo/chromaffin/mapping/split/split_out</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>samtools<span class="w"> </span>split<span class="w"> </span>-f<span class="w"> </span>%#_%*.%.<span class="w"> </span>../chromaffin.Aligned.sortedByCoord.out.bam
</span></code></pre></div>
<p>In order for the Bam file output by STAR to have the <code>@RG</code> tag, we need to add one line of command when doing the alignmnet. The last line <code>--outSAMattributes NH HI AS nM RG</code> is required for the each read in the Bam file to contain the @RG tag.</p>
<p>It worked and the overall time for the jobs are:
- Alignment: 30 minutes.
- Splitting: 30 minutes.</p>
<p>The output files are stored in <code>/scratch/2024-05-11/bio-zhanglm/bioinfo/chromaffin/mapping/split/split_out</code>.</p>
<h4 id="aligning-one-by-one">Aligning One-by-one</h4>
<p>This probably will work just fine, but it will take a long time. With this method, you can't use the soloType command since we are not using <code>starsolo</code>, but only the regular <code>STAR</code>.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Submitted as ll_star_01.txt</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>ls<span class="w"> </span>fastq/*.fastq<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line<span class="w"> </span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">do</span><span class="w"> </span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">        </span>STAR<span class="w"> </span>--runThreadN<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="se">\ </span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">                </span>--genomeDir<span class="w"> </span>/data/bio-zhanglm/genome/mm10<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">                </span>--readFilesIn<span class="w"> </span>fastq/<span class="si">${</span><span class="nv">line</span><span class="si">}</span>.fastq<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">                </span>--outFileNamePrefix<span class="w"> </span>mapping/<span class="si">${</span><span class="nv">line</span><span class="si">}</span><span class="w"> </span><span class="se">\ </span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">                </span>--outSAMtype<span class="w"> </span>BAM<span class="w"> </span>SortedByCoordinate<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">                </span>--quantMode<span class="w"> </span>GeneCounts<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="k">done</span>
</span></code></pre></div>
The job process took around 6 hours.</p>
<h3 id="velocyto-analysis">Velocyto Analysis</h3>
<p>We first performed the velocyto analysis on the one-by-one aligned BAM files. </p>
<h4 id="preperation">Preperation</h4>
<p>Before we start to do the analysis, <code>velocyto</code> analysis for the SmartSeq2 data requires two additional files. 
1. The gene annotation file in GTF format <code>Mus_musculus.GRCm39.111.gtf</code>.
2. The repeat masker file <code>mm10_rmsk.gtf</code>, .
All could be found in <code>/data/bio-zhanglm/genome/mm10/</code> directory.</p>
<h4 id="analysis">Analysis</h4>
<h5 id="one-by-one-output-bams">One-by-one output BAMs</h5>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nv">mask</span><span class="o">=</span>/data/bio-zhanglm/genome/mm10/mm10_rmsk.gtf
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nv">annotation</span><span class="o">=</span>/data/bio-zhanglm/genome/mm10/Mus_musculus.GRCm39.111.gtf
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>velocyto<span class="w"> </span>run-smartseq2<span class="w"> </span>-o<span class="w"> </span>velocyto<span class="w"> </span>-m<span class="w"> </span><span class="nv">$mask</span><span class="w"> </span>-e<span class="w"> </span>chromaffin<span class="w"> </span>mapping/*.bam<span class="w"> </span><span class="nv">$annotation</span><span class="w"> </span>
</span></code></pre></div>
Which sadly resulted in the error: 
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Traceback (most recent call last):
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/bin/velocyto&quot;, line 8, in &lt;module&gt;
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    sys.exit(cli())
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/click/core.py&quot;, line 1157, in __call__
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>    return self.main(*args, **kwargs)
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/click/core.py&quot;, line 1078, in main
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>    rv = self.invoke(ctx)
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/click/core.py&quot;, line 1688, in invoke
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    return _process_result(sub_ctx.command.invoke(sub_ctx))
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/click/core.py&quot;, line 1434, in invoke
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    return ctx.invoke(self.callback, **ctx.params)
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/click/core.py&quot;, line 783, in invoke
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>    return __callback(*args, **kwargs)
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/velocyto/commands/run_smartseq2.py&quot;, line 70, in run_smartseq2
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>    return _run(bamfile=bamfiles, gtffile=gtffile, bcfile=None, outputfolder=outputfolder,
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/velocyto/commands/_run.py&quot;, line 196, in _run
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>    mask_ivls_by_chromstrand = exincounter.read_repeats(repmask)
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/velocyto/counter.py&quot;, line 347, in read_repeats
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>    gtf_lines = sorted(gtf_lines, key=sorting_key)
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>  File &quot;/work/bio-zhanglm/conda/envs/pre/lib/python3.8/site-packages/velocyto/counter.py&quot;, line 345, in sorting_key
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>    return (x[0], x[6] == &quot;+&quot;, int(x[3]), entry)  # The last element of the touple corresponds to the `last resort comparison`
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>IndexError: list index out of range
</span></code></pre></div></p>
<h5 id="squashed-bams">Squashed BAMs</h5>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">cd</span><span class="w"> </span>/scratch/2024-05-11/bio-zhanglm/bioinfo/chromaffin
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nv">mask</span><span class="o">=</span>/data/bio-zhanglm/genome/mm10/mm10_rmsk.gtf
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="nv">annotation</span><span class="o">=</span>/data/bio-zhanglm/genome/mm10/Mus_musculus.GRCm39.111.gtf
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="nv">bam</span><span class="o">=</span>/scratch/2024-05-11/bio-zhanglm/bioinfo/chromaffin/mapping/split/split_out
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>velocyto<span class="w"> </span>run-smartseq2<span class="w"> </span>-o<span class="w"> </span>velocyto<span class="w"> </span>-m<span class="w"> </span><span class="nv">$mask</span><span class="w"> </span>-e<span class="w"> </span>chromaffin<span class="w"> </span><span class="si">${</span><span class="nv">bam</span><span class="si">}</span>/*.bam<span class="w"> </span><span class="nv">$annotation</span>
</span></code></pre></div>
Which outputs the same error as above.</p>
<h2 id="hippocampus">Hippocampus</h2>
<p>Since the SmartSeq2 chromaffin data didn't work, we wanted to try the 10x Genomics data of hippocampus to see if we can reproduce their results.</p>
<p>SmartSeq2 might not be that popular, so there aren't many solutions in the GitHub issue page, but I found a lot of people asking and answering 10x related questions.</p>
<p>In the directory <code>/scratch/2024-05-11/bio-zhanglm/bioinfo/hippocampus</code>.</p>
<p>However, this dataset seems to be too large, I've been downloading it via the command <code>geofetch -i GSE104323</code> for over 3 days now, and it seems to be still downloading. I give up.</p>
<h2 id="starting-from-aligned-bam-files">Starting from Aligned Bam files</h2>
<p>We found some pre-aligned Bam files by P.Kharchenko's lab deposited at <code>http://pklab.med.harvard.edu/velocyto/notebooks/R/chromaffin2.nb.html</code> which is great news. We can now compare the difference between our aligned Bam files and theirs.</p>
<h3 id="downloading-new-bam-files">Downloading new Bam files</h3>
<p>We just download and extract it with the following commands:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>wget<span class="w"> </span>http://pklab.med.harvard.edu/velocyto/chromaffin/bams.tar
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>tar<span class="w"> </span>xvf<span class="w"> </span>bams.tar
</span></code></pre></div>
Resulting in the following files:
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>e12.5.bams/
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>|-- A1
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>|   `-- A1_unique.bam
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>|-- A10
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>|   `-- A10_unique.bam
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>|-- A11
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>|   `-- A11_unique.bam
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>|-- A12
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>|   `-- A12_unique.bam
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>|-- A13
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>|   `-- A13_unique.bam
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>.
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>.
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>.
</span></code></pre></div></p>
<h2 id="analysis-of-velocyto">Analysis of Velocyto</h2>
<h3 id="obtaining-the-loom-files">Obtaining the <code>.loom</code> Files</h3>
<p>We then try to run velocyto on this public dataset to see if it works. This time, we followed the instructions from <a href="http://pklab.med.harvard.edu/velocyto/notebooks/R/chromaffin2.nb.html">Kharchenko's Lab</a> and removed the mask field <code>-m</code> from the command.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>velocyto<span class="w"> </span>run-smartseq2<span class="w"> </span>-o<span class="w"> </span>velocyto<span class="w"> </span><span class="si">${</span><span class="nv">bam</span><span class="si">}</span>/*/*.bam<span class="w"> </span><span class="nv">$annotation</span>
</span></code></pre></div>
Suprisingly, it worked! The output files are stored as <code>/scratch/2024-05-11/bio-zhanglm/bioinfo/chromaffin/public_bam/velocyto/onefilepercell_A10_unique_and_others_1N5XB.loom</code>. </p>
<p>Thus, we removed the <code>-m</code> field from the command for our own Bam files, and it worked as well. Seems that there is a problem with the mask data, which is reasonable since the Bam files have similar structure. The codes are shown beneath.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">cd</span><span class="w"> </span>/scratch/2024-05-11/bio-zhanglm/bioinfo/chromaffin
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="nv">mask</span><span class="o">=</span>/data/bio-zhanglm/genome/mm10/mm10_rmsk.gtf<span class="w"> </span><span class="c1"># something wrong</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nv">annotation</span><span class="o">=</span>/data/bio-zhanglm/genome/mm10/Mus_musculus.GRCm39.111.gtf
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="nv">bam</span><span class="o">=</span>/scratch/2024-05-11/bio-zhanglm/bioinfo/chromaffin/mapping/split/split_out
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>velocyto<span class="w"> </span>run-smartseq2<span class="w"> </span>-o<span class="w"> </span>velocyto<span class="w"> </span>-e<span class="w"> </span>chromaffin<span class="w"> </span><span class="si">${</span><span class="nv">bam</span><span class="si">}</span>/*.bam<span class="w"> </span><span class="nv">$annotation</span>
</span></code></pre></div>
The output from our own Bam files are stored as <code>.../bioinfo/chromaffin/velocyto/chromaffin_split.loom</code>.</p>
<p>The <code>.loom</code> files are binary, so we don't know what's the structure like. But we know that it contains information linking UMI to splicing information. This can be accessed with the <code>velocyto</code> package.</p>
<h3 id="analysis-with-r-and-python">Analysis with R and Python</h3>
<h4 id="r">R</h4>
<p>First, we need to install the required packages from the github <a href="https://github.com/velocyto-team/velocyto.R?tab=readme-ov-file"><code>velocyto.R</code> Repository</a> by using the following command:
<div class="language-R highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&quot;velocyto-team/velocyto.R&quot;</span><span class="p">)</span>
</span></code></pre></div>
R output the following error:
<div class="language-R highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">ERROR</span><span class="o">:</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="n">pcaMethods</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">velocyto.R</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="o">*</span><span class="w"> </span><span class="n">removing</span><span class="w"> </span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">R.framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="m">4.3</span><span class="o">-</span><span class="n">arm64</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">velocyto.R</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">Warning</span><span class="w"> </span><span class="n">message</span><span class="o">:</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">In</span><span class="w"> </span><span class="nf">i.p</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">  </span><span class="n">installation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">ck</span><span class="o">/</span><span class="m">9</span><span class="n">dvycsw50dz1r928cgvks0tr0000gn</span><span class="o">/</span><span class="bp">T</span><span class="o">//</span><span class="n">RtmpqeuAwC</span><span class="o">/</span><span class="n">file22d973751c84</span><span class="o">/</span><span class="n">velocyto.R_0.6.tar.gz</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span>
</span></code></pre></div></p>
<h4 id="huge-problem">Huge Problem</h4>
<p><code>velocyto</code> don't support arm64 architecture, and sadly I'm using a m1 pro chip. This will not work at all.</p>
<h3 id="analysis-with-scvelo">Analysis with scVelo</h3>
<p>When researching the follow-up works of velocyto, I found a new analysis pipeline named scVelo. Which is the counterpart of velocyto in scanpy. It assumed different splicing rates for different genes, so the model is slightly different from the original velocyto model. The analysis pipeline and results can be found in the github repository for this project.</p>

        <!-- Last update of source file -->
        
          
        
      
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022-2024 Lumi
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://space.bilibili.com/85744189" target="_blank" rel="noopener" title="Bilibili | MrBHAAA" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/BHAAA-ZLM" target="_blank" rel="noopener" title="GitHub | Lumi" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://x.com/BHAAA2021374718" target="_blank" rel="noopener" title="X(twitter) | Lumi" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.expand", "navigation.top", "navigation.expand", "navigation.indexes", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>